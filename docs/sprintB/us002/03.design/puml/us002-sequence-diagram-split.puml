@startuml
skinparam monochrome true
skinparam packageStyle rectangle
skinparam shadowing false

autonumber

'hide footbox
actor "Agent" as ADM
participant ":PublishAnnouncementUI" as UI
participant ":PublishAnnouncementController" as CTRL
participant "agency\n:Agency" as AGENCY

activate ADM

        ADM -> UI : asks to publish an announcement

        activate UI

'            UI --> ADM : requests data (reference, description,  informal \n description, technical description, duration, cost)
            'create CTRL
            UI -> CTRL** : create

            UI -> CTRL : getCommissionTypeList()

            ref over CTRL
                        Get Commission Type List
            end ref

            activate CTRL

                CTRL --> UI : commissionTypeList
            deactivate CTRL

            UI --> ADM : shows type of commission list\n and asks to select one
        deactivate UI

    ADM -> UI : selects a type of commission
    activate UI

        UI --> UI : keepCommissionType(typeCommission)

    UI --> ADM : requests value of commission
    deactivate UI

    ADM -> UI : enters commission value
    activate UI

        UI --> UI : keepCommissionValue(commissionValue)

            UI -> CTRL : getTypePropertyList)

            ref over CTRL
                        Get Property Type List
            end ref

            activate CTRL


                CTRL --> UI : PropertyTypeList
            deactivate CTRL


        UI --> ADM : shows types of properties and asks to select one
    deactivate UI

    ADM -> UI : selects a type of property
    activate UI
   UI --> UI : keepPropertyType(propertyType)

    UI --> ADM : requests data
    deactivate UI

    ADM -> UI : types requested data
    activate UI
note right of ADM: steps with alternatives of request data omitted until further notice


    UI --> ADM : shows all data and asks for confirmation
        deactivate UI

    ADM -> UI : submits data
    activate UI

        UI -> CTRL : createProperty()
        activate CTRL

        deactivate CTRL

        UI -> CTRL : publishAnnouncement(commissionType, commissionValue, ownerEmail, property)
        activate CTRL

            |||
            CTRL -> CTRL : getAgentFromSession()

                ref over CTRL
                    Get Agent
                end ref

                activate CTRL

                CTRL --> CTRL : agent
            deactivate CTRL

            |||
            CTRL -> AGENCY: publishAnnouncement(agent, typeCommission, commissionValue, ownerEmail, property)


                ref over AGENCY
                    Publish Announcement
                end ref

                activate AGENCY

            AGENCY --> CTRL: announcement
            deactivate AGENCY

            CTRL --> UI: announcement
            deactivate CTRL

            UI --> ADM: displays operation success
            deactivate UI

deactivate ADM

@enduml