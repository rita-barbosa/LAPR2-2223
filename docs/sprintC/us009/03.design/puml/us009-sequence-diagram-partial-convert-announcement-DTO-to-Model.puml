@startuml
skinparam monochrome true
skinparam packageStyle rectangle
skinparam shadowing false


participant ":ScheduleVisitController" as CTRL
participant ":AnnouncementMapper" as MAPPER
participant "announcementDto\n:AnnouncementDto" as ANCDTO
participant "agencyRepository\n:AgencyRepository" as AgencyRepository
participant "agency\n:Agency" as AGC
participant "announcementList\n:AnnouncementList" as LISTCLASS
participant "announcement\n:Announcement" as ANNOUNCE


autonumber 7

 -> CTRL : convertToModel(announcementDto)

activate CTRL

    autonumber 7.1

    group Convert Announcement DTO to Model

        CTRL -> MAPPER : announcementId = getAnnouncementIdFromDto(announcementDto)
        activate MAPPER

        MAPPER -> ANCDTO : getAnnouncementId()
        activate ANCDTO

            ANCDTO --> MAPPER : announcementId
        deactivate ANCDTO

            MAPPER --> CTRL : announcementId
        deactivate MAPPER

        CTRL -> AgencyRepository : searchAnnouncementById(announcementId)
        activate AgencyRepository

        loop for all agencies

            AgencyRepository -> AGC : searchAnnouncementById(announcementId)
            activate AGC

                AGC -> LISTCLASS : searchAnnouncementById(announcementId)

                loop for all announcements

                    activate LISTCLASS

                    LISTCLASS --> ANNOUNCE : hasSameId(id)

                    activate ANNOUNCE

                        ANNOUNCE --> LISTCLASS : true/false
                    deactivate ANNOUNCE

                end loop

        end loop

        LISTCLASS -> ANNOUNCE : getAnnouncementById(announcementId)
        activate ANNOUNCE

            ANNOUNCE --> LISTCLASS : announcement
        deactivate ANNOUNCE

            LISTCLASS --> AGC : announcement
        deactivate LISTCLASS

            AGC --> AgencyRepository : announcement
        deactivate AGC

            AgencyRepository --> CTRL : announcement
        deactivate AgencyRepository

    end group

    autonumber 8

    <-- CTRL  : Announcement
deactivate CTRL

@enduml