@startuml
skinparam monochrome true
skinparam packageStyle rectangle
skinparam shadowing false

participant "agencyRepository\n:AgencyRepository" as AgencyRepository
participant "agency\n:Agency" as AGC
participant "announcementList\n:AnnouncementList" as AnnounceList
participant "allDataList\n: List<List<Double>>" as AllDataList
participant "dataList\n: List<List<Double>>" as DL
participant "announcement\n:Announcement" as Announce
participant "data\n: List<Double>" as Data
participant "request\n:Request" as Request

autonumber
-> AgencyRepository : getAgenciesAnnouncementDataListForSLR(parameter)
    activate AgencyRepository

group Get all data for SLR analysis

    AgencyRepository -> AllDataList** : create()
        note right
        **THIS IS A BIDIMENSIONAL LIST**
        end note

         loop for all agencies
               AgencyRepository -> AGC : getAnnouncementDataByParameter(parameter)
               activate AGC


               AGC -> AnnounceList : getAnnouncementDataByParameter(parameter)
               activate AnnounceList

               AnnounceList -> DL** : create()

               loop for each announcement

               AnnounceList -> Announce : isDeal()
               activate Announce

               Announce --> AnnounceList: true/false
               deactivate Announce

               alt true
               AnnounceList -> Announce : verifyPropertyTypeIsResidence()
               activate Announce

               Announce -> Request : isPropertyTypeResidence()
               activate Request

               Request --> Announce: isResidence
               deactivate Request

               Announce --> AnnounceList: isResidence
               deactivate Announce

               alt isResidence

               AnnounceList -> Announce : getDataForSLR(parameter)
               activate Announce

                Announce -> Data**: create()

               Announce -> Announce: getSaleAmount()
               activate Announce

               Announce --> Announce: saleAmount
               deactivate Announce
                |||
               Announce -> Data: add(orderValue)
               activate Data
               deactivate Data

               Announce -> Request: getParameterValue(parameter)
               activate Request

               Request -> Announce: parameterValue
               deactivate Request
                |||
               Announce -> Data: add(parameterValue)
               activate Data
               deactivate Data


               note right Announce
                    This method will return
                    the value of parameter and
                    the property deal price
               end note

               Announce --> AnnounceList : data
               deactivate Announce


               AnnounceList -> DL : add(data)
               activate DL
               deactivate DL
               end alt
               |||
               end alt
               |||
               end loop
               AnnounceList --> AGC : dataList
               deactivate AnnounceList

               AGC --> AgencyRepository : dataList
               deactivate AGC

               AgencyRepository -> AllDataList : addAll(dataList)
               activate AllDataList
               deactivate AllDataList
          |||
          end loop

end group
        <-- AgencyRepository  : allDataList
        deactivate AgencyRepository


@enduml